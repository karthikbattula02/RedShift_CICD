name: CI/CD Pipeline

on:
  push:   # runs on every push
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Run build
        run: echo "Running build pipeline..."

      - name: Send Success Mail
        if: success()
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 465
          username: ${{ secrets.SMTP_USERNAME }}
          password: ${{ secrets.SMTP_PASSWORD }}
          subject: "✅ Webhook & Workflow Success - ${{ github.repository }}"
          to: yourmail@example.com
          from: Github Actions <yourmail@example.com>
          body: |
            The workflow for repository **${{ github.repository }}**
            was successfully triggered by webhook & completed.

      - name: Send Failure Mail
        if: failure()
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 465
          username: ${{ secrets.SMTP_USERNAME }}
          password: ${{ secrets.SMTP_PASSWORD }}
          subject: "❌ Webhook/Workflow Failed - ${{ github.repository }}"
          to: yourmail@example.com
          from: Github Actions <yourmail@example.com>
          body: |
            The workflow for repository **${{ github.repository }}**
            failed after webhook trigger.
